<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GPS & Distance Helper</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --muted: #94a3b8;
      --text: #e5e7eb;
      --accent: #10b981;
      --accent-2: #38bdf8;
      --danger: #ef4444;
      --warn: #f59e0b;
      --card: #0b1220;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 70% -10%, #0b1d34 0%, var(--bg) 45%);
      color: var(--text);
      display: grid;
      place-items: start center;
      padding: 24px;
    }
    .container { width: min(980px, 100%); display: grid; gap: 16px; }
    header {
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: 16px;
      background: linear-gradient(180deg, #0c1425 0%, #0a0f1a 100%);
      box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
    }
    header h1 { font-size: clamp(18px, 3.6vw, 24px); margin: 0; }
    header .hint { color: var(--muted); font-size: 13px; }

    .grid { display: grid; gap: 16px; grid-template-columns: 1fr; }
    @media (min-width: 860px) { .grid { grid-template-columns: 1fr 1fr; } }

    .card {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, #0a0f1b 0%, #0a0e18 100%);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 28px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
    }

    .card h2 { margin: 0 0 8px; font-size: 18px; }
    .sub { color: var(--muted); font-size: 13px; margin-bottom: 12px; }
    .row, .row-3 { display: grid; gap: 10px; }
    .row { grid-template-columns: 1fr 1fr; }
    .row-3 { grid-template-columns: 1fr 1fr 1fr; }
    label { font-size: 12px; color: var(--muted); margin-bottom: 6px; display: block; }

    input, select, button {
      width: 100%;
      border: 1px solid var(--border);
      background: #0b1220;
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 14px;
      outline: none;
    }

    button {
      cursor: pointer;
      background: linear-gradient(180deg, #1b2a3f 0%, #132235 100%);
      transition: transform .05s ease, filter .2s ease;
    }
    button:hover { filter: brightness(1.1); }
    button:active { transform: translateY(1px); }

    .pill {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 999px;
      background: #0b1220; border: 1px solid var(--border);
      font-size: 13px; color: var(--muted);
    }
    .ok { color: var(--accent); }
    .warn { color: var(--warn); }
    .err { color: var(--danger); }

    .mono { font-family: monospace; font-size: 13px; color: #cbd5e1; }
    .value { display: block; padding: 8px 10px; border-radius: 10px; background: #0b1220; border: 1px solid var(--border); }

    .result {
      display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; align-items: center;
      padding: 8px 10px; border-radius: 12px; background: #0b1220; border: 1px solid var(--border);
    }
    .result strong { font-size: 20px; }

    footer { color: var(--muted); font-size: 12px; text-align: center; margin-top: 6px; }
    .small { font-size: 12px; color: var(--muted); }
    .hr { height: 1px; background: var(--border); margin: 12px 0; border-radius: 999px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>GPS & Distance Helper</h1>
      <div class="hint">Works best on HTTPS (or localhost) with location permission enabled.</div>
    </header>

    <div class="grid">
      <!-- CURRENT LOCATION -->
      <section class="card">
        <h2>Current Location</h2>
        <p class="sub">Get your current coordinates.</p>
        <div class="row-3">
          <button id="btnLocate">Get location</button>
          <button id="btnWatch">Start live</button>
          <button id="btnStop" disabled>Stop</button>
        </div>
        <div class="hr"></div>
        <div class="row">
          <div><label>Latitude</label><code id="lat" class="value mono">â€“</code></div>
          <div><label>Longitude</label><code id="lng" class="value mono">â€“</code></div>
        </div>
        <div class="row">
          <div><label>Accuracy (m)</label><code id="acc" class="value mono">â€“</code></div>
          <div><label>Timestamp</label><code id="ts" class="value mono">â€“</code></div>
        </div>
        <p id="geoStatus" class="pill warn">Geolocation status: idle</p>
      </section>

      <!-- DISTANCE CALC -->
      <section class="card">
        <h2>Distance Calculator</h2>
        <p class="sub">Calculates distance and direction (A â†’ B).</p>
        <div class="row-3">
          <button id="useCurrentForA">Use current â†’ A</button>
          <button id="useCurrentForB">Use current â†’ B</button>
          <button id="btnAuto">Toggle auto-update</button>
        </div>
        <div class="row">
          <div><label>Point A â€” Latitude</label><input id="aLat" type="number" step="any" /></div>
          <div><label>Point A â€” Longitude</label><input id="aLng" type="number" step="any" /></div>
        </div>
        <div class="row">
          <div><label>Point B â€” Latitude</label><input id="bLat" type="number" step="any" /></div>
          <div><label>Point B â€” Longitude</label><input id="bLng" type="number" step="any" /></div>
        </div>
        <div class="row">
          <div>
            <label>Units</label>
            <select id="units">
              <option value="m">Meters</option>
              <option value="km">Kilometers</option>
              <option value="mi">Miles</option>
              <option value="nm">Nautical Miles</option>
            </select>
          </div>
          <div style="display:flex;align-items:end;"><button id="btnCalc">Calculate</button></div>
        </div>
        <div class="hr"></div>
        <div class="result">
          <div><div class="small">Distance</div><strong id="outDist">â€“</strong></div>
          <div><div class="small">Bearing</div><strong id="outBear">â€“</strong></div>
          <div><div class="small">Direction</div><strong id="outDir">â€“</strong></div>
        </div>
      </section>
    </div>

    <footer>Built with Geolocation API. Your data stays on-device.</footer>
  </div>

  <script>
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => [...r.querySelectorAll(s)];
    function toRad(d){return d*Math.PI/180;}
    function toDeg(r){return r*180/Math.PI;}
    function fmt(n,d=6){return Number.isFinite(n)?n.toFixed(d).replace(/\.0+$/,''):'â€“';}
    function hav(a1,o1,a2,o2){const R=6371e3;const Ï†1=toRad(a1),Ï†2=toRad(a2),Î”Ï†=toRad(a2-a1),Î”Î»=toRad(o2-o1);const x=Math.sin(Î”Ï†/2)**2+Math.cos(Ï†1)*Math.cos(Ï†2)*Math.sin(Î”Î»/2)**2;return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));}
    function bearing(a1,o1,a2,o2){const Ï†1=toRad(a1),Ï†2=toRad(a2),Î»1=toRad(o1),Î»2=toRad(o2);const y=Math.sin(Î»2-Î»1)*Math.cos(Ï†2);const x=Math.cos(Ï†1)*Math.sin(Ï†2)-Math.sin(Ï†1)*Math.cos(Ï†2)*Math.cos(Î»2-Î»1);return (toDeg(Math.atan2(y,x))+360)%360;}
    function convert(m,u){switch(u){case'km':return m/1000;case'mi':return m/1609.344;case'nm':return m/1852;default:return m;}}
    function cardinal(b){return['N','NE','E','SE','S','SW','W','NW'][Math.round(b/45)%8];}
    function status(t,m='warn'){const e=$('#geoStatus');e.textContent=`Geolocation status: ${t}`;e.className=`pill ${m}`;}

    let watchId=null,auto=false,alertShown=false;
    const opts={enableHighAccuracy:true,timeout:10000,maximumAge:0};

    if('Notification'in window && Notification.permission==='default') Notification.requestPermission();

    function onPos(p){$('#lat').textContent=fmt(p.coords.latitude,6);$('#lng').textContent=fmt(p.coords.longitude,6);$('#acc').textContent=fmt(p.coords.accuracy,1);$('#ts').textContent=new Date(p.timestamp).toLocaleString();status('active','ok');if(auto)fill('B');}
    function onErr(e){status('Error: '+e.message,'err');}

    $('#btnLocate').onclick=()=>navigator.geolocation.getCurrentPosition(onPos,onErr,opts);
    $('#btnWatch').onclick=()=>{if(watchId)return;watchId=navigator.geolocation.watchPosition(onPos,onErr,opts);$('#btnStop').disabled=false;status('watching','ok');};
    $('#btnStop').onclick=()=>{if(watchId){navigator.geolocation.clearWatch(watchId);watchId=null;status('stopped');}$('#btnStop').disabled=true;};

    function read(){const aLat=parseFloat($('#aLat').value),aLng=parseFloat($('#aLng').value),bLat=parseFloat($('#bLat').value),bLng=parseFloat($('#bLng').value);if([aLat,aLng,bLat,bLng].some(v=>!Number.isFinite(v)))return null;return{aLat,aLng,bLat,bLng};}

    function update(){
      const v=read();if(!v)return;
      const d=hav(v.aLat,v.aLng,v.bLat,v.bLng),b=bearing(v.aLat,v.aLng,v.bLat,v.bLng),u=$('#units').value;
      $('#outDist').textContent=`${fmt(convert(d,u),u==='m'?0:3)} ${u}`;
      $('#outBear').textContent=`${fmt(b,1)}Â°`;
      $('#outDir').textContent=`${cardinal(b)} (${fmt(b,1)}Â°)`;

      if(d<50){
        if(!alertShown){
          alertShown=true;
          $('#outDist').style.color='var(--accent)';
          $('#outDist').animate([{transform:'scale(1.1)'},{transform:'scale(1)'}],{duration:600,iterations:3});
          if('Notification'in window && Notification.permission==='granted') new Notification('ðŸš¶ You are within 50 meters of your target!');
          else alert('ðŸš¶ You are within 50 meters of your target!');
        }
      }else{alertShown=false;$('#outDist').style.color='inherit';}
    }

    $('#btnCalc').onclick=update;
    $('#units').onchange=update;
    $('#btnAuto').onclick=()=>{auto=!auto;$('#btnAuto').textContent=auto?'Auto-update: ON':'Toggle auto-update';if(auto)update();};
    ['#aLat','#aLng','#bLat','#bLng'].forEach(s=>$(s).addEventListener('input',()=>{if(auto)update();}));

    function fill(t){const lat=parseFloat($('#lat').textContent),lng=parseFloat($('#lng').textContent);if(!Number.isFinite(lat)||!Number.isFinite(lng))return status('Get location first','warn');if(t==='A'){$('#aLat').value=lat;$('#aLng').value=lng;}if(t==='B'){$('#bLat').value=lat;$('#bLng').value=lng;}update();}
    $('#useCurrentForA').onclick=()=>fill('A');
    $('#useCurrentForB').onclick=()=>fill('B');

    (()=>{
      const https=location.protocol==='https:'||['localhost','127.0.0.1'].includes(location.hostname);
      status(https?'ready':'Needs HTTPS or localhost',https?'ok':'warn');
    })();
  </script>
</body>
</html>

